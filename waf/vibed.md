# Vibe.d

まず特徴を知るのが大事

1.どう対策できるか

## 特徴

- 非同期I/O+軽量スレッドのウェブサーバ
  - 大量同時接続を1プロセスでさばける (参考:C10K問題)
  - スレッドでブロックすると全体のスループットに影響
    - 非同期I/Oを使っているところでEAGAINなエラーであればはFiberのスイッチで処理が切り替わるので問題ない
    - そうでない場合(ディスクI/Oやlibmysqlclientなど同期I/Oを使っているネットワークI/O)ではこの問題がおきる
- 基本的な機能は実装
  - セッション(オンメモリ,Redis)
  - ロギング
  - テンプレートエンジン(diet-ng)
  - ルーティング

## ノウハウ

- ブロックをなるべく起こさないようにする
  - ソケットを使う場合はなるべくvibe.dのコアのリアクターを使うものにする
    - vibe.d内のredisモジュールやmysql-nativeなどのライブラリ
    - 軽量スレッドでスイッチする仕組みの恩恵がうけられるため
  - ディスクI/Oなどは別スレッドへ逃してやり結果を後でうけとる形にする
